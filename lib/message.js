window.Messenger=(function(){var d="[PROJECT_NAME]",a="postMessage" in window;function c(h,e,g){var f="";if(arguments.length<2){f="target error - target and name are both required"}else{if(typeof h!="object"){f="target error - target itself must be window object"}else{if(typeof e!="string"){f="target error - target name must be string type"}}}if(f){throw new Error(f)}this.target=h;this.name=e;this.prefix=g}if(a){c.prototype.send=function(e){this.target.postMessage(this.prefix+"|"+this.name+"__Messenger__"+e,"*")}}else{c.prototype.send=function(f){var e=window.navigator[this.prefix+this.name];if(typeof e=="function"){e(this.prefix+f,window)}else{throw new Error("target callback function is not defined")}}}function b(f,e){this.targets={};this.name=f;this.listenFunc=[];this.prefix=e||d;this.initListen()}b.prototype.addTarget=function(g,e){var f=new c(g,e,this.prefix);this.targets[e]=f};b.prototype.initListen=function(){var f=this;var e=function(m){if(typeof m=="object"&&m.data){m=m.data}var l=m.split("__Messenger__");var m=l[1];var k=l[0].split("|");var j=k[0];var g=k[1];for(var h=0;h<f.listenFunc.length;h++){if(j+g===f.prefix+f.name){f.listenFunc[h](m)}}};if(a){if("addEventListener" in document){window.addEventListener("message",e,false)}else{if("attachEvent" in document){window.attachEvent("onmessage",e)}}}else{window.navigator[this.prefix+this.name]=e}};b.prototype.listen=function(h){var f=0;var e=this.listenFunc.length;var g=false;for(;f<e;f++){if(this.listenFunc[f]==h){g=true;break}}if(!g){this.listenFunc.push(h)}};b.prototype.clear=function(){this.listenFunc=[]};b.prototype.send=function(g){var e=this.targets,f;for(f in e){if(e.hasOwnProperty(f)){e[f].send(g)}}};return b})();